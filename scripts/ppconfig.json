{"name":"daefabbbfa","url":"https://jellyfishiland.netlify.app/","showName":"Jellyfish","appid":"com.jellyfishiland.app","icon":"","iconPath":"C:\\Users\\Administrator\\AppData\\Roaming\\com.pakeplus.pacbao\\daefabbbfa.png","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":true,"version":"0.0.1","preview":"iPhone","platform":["1-1","2-2"],"width":430,"height":932,"desc":"","jsFile":[],"filterCss":"","customJs":"// very important, if you don't know what it is, don't touch it\n// 非常重要，不懂代码不要动，这里可以解决80%的问题，也可以生产1000+的bug\n\n// 这是一个异步函数，因为文件保存操作是异步的\nconst hookClick = async (e) => {\n    const origin = e.target.closest('a');\n    if (!origin || !origin.href) {\n        return; // 如果点击的不是链接，直接返回\n    }\n\n    // --- 核心修改：拦截下载链接并使用原生API保存 ---\n    const isDownloadLink = origin.hasAttribute('download') || origin.href.startsWith('blob:');\n\n    if (isDownloadLink) {\n        console.log('Download link intercepted, handling with native API.', origin.href);\n        // 1. 阻止默认的、会失败的下载行为\n        e.preventDefault();\n        e.stopPropagation(); // 同时阻止事件冒泡，以防其他脚本干扰\n\n        try {\n            // 2. 获取要下载的数据内容\n            // 使用 fetch API 读取 blob: URL 的内容\n            const response = await fetch(origin.href);\n            const data = await response.text(); // 假设是文本文件，如 JSON, CSV, TXT\n\n            // 3. 调用 Tauri 原生保存对话框\n            // origin.download 是 <a> 标签上建议的文件名，我们把它作为默认名\n            const filePath = await window.__TAURI__.dialog.save({\n                defaultPath: origin.download || 'downloaded-file'\n            });\n\n            if (filePath) {\n                // 4. 如果用户选择了路径 (没有取消), 则调用原生 API 写入文件\n                await window.__TAURI__.fs.writeTextFile(filePath, data);\n                console.log('File saved successfully to:', filePath);\n                // 可以在这里加一个成功的提示，如果你的网页有通知组件的话\n            } else {\n                console.log('User cancelled the save dialog.');\n            }\n        } catch (error) {\n            console.error('Failed to download file:', error);\n            // 可以在此提示用户下载失败\n            alert(`文件导出失败: ${error}`);\n        }\n\n        return; // 处理完毕，退出函数\n    }\n    // --- 核心修改结束 ---\n\n\n    // --- 保留原有逻辑：处理在新窗口打开的链接 ---\n    const isBaseTargetBlank = document.querySelector('head base[target=\"_blank\"]');\n    if (\n        (origin.target === '_blank') || isBaseTargetBlank\n    ) {\n        e.preventDefault();\n        console.log('handle origin _blank link', origin.href);\n        location.href = origin.href;\n    } else {\n        console.log('not handle origin', origin);\n    }\n};\n\nwindow.open = function (url, target, features) {\n    console.log('window.open intercepted, redirecting to', url);\n    location.href = url;\n};\n\n// 使用 { capture: true } 确保我们的脚本最先执行\ndocument.addEventListener('click', hookClick, { capture: true });\n\nconsole.log('Pakeplus custom script with native download handler loaded.');\n","isHtml":false,"htmlPath":"","htmlFiles":[],"prefix":"","pcRepo":"PakePlus-v2.1.3","iosRepo":"PakePlus-iOS-v2.1.3","androidRepo":"PakePlus-Android-v2.1.3","more":{"windows":{"label":"","title":"Jellyfish","url":"https://jellyfishiland.netlify.app/","userAgent":"Mozilla/5.0 (iPhone; CPU iPhone OS 17_0_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1","width":430,"height":932,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"shadow":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"backgroundColor":null,"backgroundThrottling":null,"javascriptDisabled":false}},"phone":{"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"daefabbbfa","showName":"Jellyfish","version":"0.0.1","webUrl":"https://jellyfishiland.netlify.app/","id":"com.jellyfishiland.app.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"android":{"name":"daefabbbfa","showName":"Jellyfish","version":"0.0.1","webUrl":"https://jellyfishiland.netlify.app/","id":"com.jellyfishiland.app.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"desktop":{"name":"daefabbbfa","showName":"Jellyfish","version":"0.0.1","id":"com.jellyfishiland.app.desktop","desc":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","webUrl":"https://jellyfishiland.netlify.app/","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":false,"buildMethod":"cloud","debug":false}}